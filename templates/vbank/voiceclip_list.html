{% extends "voice_clips_base.html" %}

{% block page_title %}&mdash; Voice Clips{% endblock %}

{% load vbank_tags %}

{% load thumbnail %}

{% block find_voices %}
{% with urlname=request.resolver_match.url_name %}
  <li {% if urlname == 'all_clips' %}class="active"{% endif %}>
    <a href="{% url 'all_clips' %}">
      <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Find Voices
      {% if urlname == 'all_clips' %}
        <span class="sr-only">(current)</span></a>
      {% endif %}
    </a>
  </li>
{% endwith %}
{% endblock %}

{% block nav_items %}
{% with urlname=request.resolver_match.url_name %}
  <ul class="nav navbar-nav navbar-right">
    <li><a href="{% url 'about' %}">About Us</a></li>
    <li {% if urlname == 'all_clips' %}class="active"{% endif %}>
      <a href="{% url 'all_clips' %}">
        Find Voices
        {% if urlname == 'all_clips' %}
          <span class="sr-only">(current)</span></a>
        {% endif %}
      </a>
    </li>
    <li><a href="#">Blog</a></li>
    <li><a>+234 803 493 0227</a></li>
    <li><a href="{% url 'join' %}">Sign Up</a></li>
    {% if user.is_authenticated %}
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
          {{ user.get_full_name }} <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li><a href="{{ user.profile.get_absolute_url }}">View Profile</a></li>
          <li><a href="{% url 'profile_edit' %}">Edit Profile</a></li>
          <li><a href="{% url 'voiceclips' %}">Upload Voice Clip</a></li>
          <li role="separator" class="divider"></li>
          <li><a href="logout">Log Out</a></li>
        </ul>
      </li>
    {% else %}
      <li><a href="{% url 'login' %}?next={{ request.path }}">Log In</a></li>
    {% endif %}
  </ul>
{% endwith %}
{% endblock %}

{% block app %}
<div class="container">
  <div class="voiceclips row">
    <div class="col-md-4">
      <div class="page-header">
        <h2>Search <small class="pull-right"><a href="{% url 'all_clips' %}">All Voice Clips</a></small></h2>
      </div>
      <form method="post" class="clip-search">
        {% csrf_token %}
	{{ form.non_field_errors }}
        <div class="form-group">
          {{ form.category.errors }}
          <label for="{{ form.category.id_for_label }}">{{ form.category.label }}</label>
          {{ form.category }}
        </div>
        <div class="form-group">
          {{ form.language.errors }}
          <label for="{{ form.language.id_for_label }}">{{ form.language.label }}</label>
          {{ form.language }}
        </div>
        <div class="form-group">
          {{ form.gender.errors }}
          <label for="{{ form.gender.id_for_label }}">{{ form.gender.label }}</label>
          {{ form.gender }}
        </div>
        <div class="form-group">
          {{ form.age_group.errors }}
          <label for="{{ form.age_group.id_for_label }}">{{ form.age_group.label }}</label>
          {{ form.age_group }}
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
    </div>
    <div class="col-md-8">
      <div class="row">
        <div class="col-md-12">
          <div class="page-header">
            <h3>{{ page_header }}</h3>
          </div>
        </div>
      </div>
      <div class="row">
        {% if voiceclip_list %}
          {% for clip in voiceclip_list %}
            {% if clip.is_active %}
              <div class="col-md-6">
                {% display_clip clip %}
              </div>
            {% endif %}
          {% endfor %}
        {% else %}
          <div class="col-md-12"><p>There are no voice clips.</p></div>
        {% endif %}
      </div>
      <div class="row">
        <nav>
          <ul class="pager">
            {% if voiceclip_list.has_previous %}
              <li class="previous col-md-6">
              <a href="?page={{ voiceclip_list.previous_page_number }}{% if form.category.value %}&category={{ form.category.value }}{% endif %}{% if form.language.value %}&language={{ form.language.value }}{% endif %}{% if form.gender.value %}&gender={{ form.gender.value }}{% endif %}{% if form.age_group.value %}&age_group={{ form.age_group.value }}{% endif %}">
                  <span aria-hidden="true">&larr;</span> Previous
                </a>
              </li>
            {% endif %}
            {% if voiceclip_list.has_next %}
              <li class="next col-md-6 pull-right">
                <a href="?page={{ voiceclip_list.next_page_number }}{% if form.category.value %}&category={{ form.category.value }}{% endif %}{% if form.language.value %}&language={{ form.language.value }}{% endif %}{% if form.gender.value %}&gender={{ form.gender.value }}{% endif %}{% if form.age_group.value %}&age_group={{ form.age_group.value }}{% endif %}">
                  Next <span aria-hidden="true">&rarr;</span>
                </a>
              </li>
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>
{% endblock %}
